{
  "id": "program-sudoku-silen-v2",
  "type": "executable",
  "title": "ðŸŽ® SUDOKU ðŸ§©",
  "parentId": "folder-1766530794088863",
  "content": {
    "nodes": [
      {
        "id": "node-start-sudoku",
        "type": "start",
        "x": 50,
        "y": 50,
        "inputs": [],
        "outputs": [
          "out"
        ],
        "values": {},
        "uiFlags": {}
      },
      {
        "id": "node-sudoku-engine",
        "type": "sudoku-silenos-znh-v2",
        "x": 350,
        "y": 80,
        "inputs": [
          "open"
        ],
        "outputs": [
          "game_complete"
        ],
        "values": {
          "titulo": "Sudoku: VisiÃ³n NumÃ©rica"
        },
        "uiFlags": {
          "titulo": false
        }
      }
    ],
    "connections": [
      {
        "fromNode": "node-start-sudoku",
        "fromPort": "out",
        "toNode": "node-sudoku-engine",
        "toPort": "open"
      }
    ],
    "panX": 0,
    "panY": 0,
    "scale": 1,
    "embeddedModules": [
      {
        "id": "sudoku-silenos-znh-v2",
        "title": "Sudoku (Z-N-H-W)",
        "color": "#6366f1",
        "inputs": [
          "open"
        ],
        "outputs": [
          "game_complete"
        ],
        "fields": [
          {
            "name": "titulo",
            "type": "text",
            "value": "Sudoku Silenos"
          }
        ],
        "code": "\nconst winId = 'sudoku-znh-window';\nconst existing = document.getElementById(winId);\nif (existing) { existing.remove(); return; }\n\n// --- ESTADO (N-X-W) ---\nlet grid = Array(9).fill().map(() => Array(9).fill(0));\nlet initialGrid = Array(9).fill().map(() => Array(9).fill(0));\nlet selected = { r: -1, c: -1 };\nlet difficulty = 'EASY'; \n\nconst diffSettings = {\n    'EASY': 35,\n    'MEDIUM': 48,\n    'HARD': 58\n};\n\n// --- LÃ“GICA DE GENERACIÃ“N (Z-H) ---\nconst isValid = (board, r, c, num) => {\n    for (let x = 0; x < 9; x++) if (board[r][x] === num || board[x][c] === num) return false;\n    let startRow = r - r % 3, startCol = c - c % 3;\n    for (let i = 0; i < 3; i++)\n        for (let j = 0; j < 3; j++)\n            if (board[i + startRow][j + startCol] === num) return false;\n    return true;\n};\n\nconst solve = (board) => {\n    for (let r = 0; r < 9; r++) {\n        for (let c = 0; c < 9; c++) {\n            if (board[r][c] === 0) {\n                for (let num = 1; num <= 9; num++) {\n                    if (isValid(board, r, c, num)) {\n                        board[r][c] = num;\n                        if (solve(board)) return true;\n                        board[r][c] = 0;\n                    }\n                }\n                return false;\n            }\n        }\n    }\n    return true;\n};\n\nconst generatePuzzle = (diff) => {\n    grid = Array(9).fill().map(() => Array(9).fill(0));\n    for(let i=0; i<9; i+=3) {\n        let nums = [1,2,3,4,5,6,7,8,9].sort(() => Math.random() - 0.5);\n        for(let r=0; r<3; r++) for(let c=0; c<3; c++) grid[i+r][i+c] = nums.pop();\n    }\n    solve(grid);\n    initialGrid = grid.map(row => [...row]);\n    let count = diffSettings[diff];\n    while (count > 0) {\n        let r = Math.floor(Math.random() * 9), c = Math.floor(Math.random() * 9);\n        if (initialGrid[r][c] !== 0) {\n            initialGrid[r][c] = 0;\n            count--;\n        }\n    }\n    grid = initialGrid.map(row => [...row]);\n    selected = { r: -1, c: -1 };\n};\n\n// --- INTERFAZ (F-D) ---\nconst win = document.createElement('div');\nwin.id = winId;\nwin.style.cssText = `\n    position: absolute; top: 50px; left: 250px; width: 380px;\n    z-index: 9999; display: flex; flex-direction: column;\n    background: #e0e5ec; border-radius: 24px;\n    box-shadow: 12px 12px 24px #b8b9be, -12px -12px 24px #ffffff;\n    overflow: hidden; font-family: sans-serif;\n`;\n\nconst header = document.createElement('div');\nheader.style.cssText = `\n    padding: 15px; display: flex; justify-content: space-between;\n    align-items: center; cursor: grab; border-bottom: 1px solid rgba(0,0,0,0.05);\n`;\nheader.innerHTML = `\n    <span style=\"font-weight:900; color:#475569; font-size:0.7rem; letter-spacing:1px;\">ðŸ§© ${ctx.fields.titulo || 'SUDOKU'}</span>\n    <button id=\"close-${winId}\" style=\"border:none; background:transparent; cursor:pointer; font-size:1.2rem; color:#888;\">Ã—</button>\n`;\n\nconst body = document.createElement('div');\nbody.style.cssText = `padding: 20px; display: flex; flex-direction: column; align-items: center; gap: 15px;`;\n\n// SELECTOR DE DIFICULTAD (W)\nconst diffSelector = document.createElement('div');\ndiffSelector.style.cssText = `display: flex; background: rgba(0,0,0,0.03); padding: 4px; border-radius: 12px; width: 100%; gap: 4px;`;\n\nconst diffBtns = {};\n['EASY', 'MEDIUM', 'HARD'].forEach(d => {\n    const btn = document.createElement('button');\n    btn.innerText = d;\n    btn.style.cssText = `flex: 1; border: none; padding: 8px; border-radius: 8px; font-size: 0.6rem; font-weight: bold; cursor: pointer; transition: 0.3s; background: ${difficulty === d ? '#6366f1' : 'transparent'}; color: ${difficulty === d ? '#fff' : '#718096'};`;\n    btn.onclick = () => {\n        difficulty = d;\n        Object.values(diffBtns).forEach(b => { b.style.background = 'transparent'; b.style.color = '#718096'; });\n        btn.style.background = '#6366f1'; btn.style.color = '#fff';\n        generatePuzzle(d);\n        drawGrid();\n        ctx.log(\"Dificultad: \" + d);\n    };\n    diffBtns[d] = btn;\n    diffSelector.append(btn);\n});\n\nconst gridEl = document.createElement('div');\ngridEl.style.cssText = `\n    display: grid; grid-template-columns: repeat(9, 35px);\n    grid-template-rows: repeat(9, 35px); border: 3px solid #a3b1c6;\n    border-radius: 8px; background: #a3b1c6; gap: 1px;\n`;\n\nconst drawGrid = () => {\n    gridEl.innerHTML = '';\n    for (let r = 0; r < 9; r++) {\n        for (let c = 0; c < 9; c++) {\n            const cell = document.createElement('div');\n            const isInitial = initialGrid[r][c] !== 0;\n            const isSelected = selected.r === r && selected.c === c;\n            const bRight = (c + 1) % 3 === 0 && c < 8 ? '2px solid #475569' : '0px';\n            const bBottom = (r + 1) % 3 === 0 && r < 8 ? '2px solid #475569' : '0px';\n\n            cell.style.cssText = `\n                width: 35px; height: 35px; background: ${isSelected ? '#cbd5e0' : '#e0e5ec'};\n                display: flex; align-items: center; justify-content: center;\n                font-weight: ${isInitial ? '900' : '400'};\n                color: ${isInitial ? '#2d3748' : '#6366f1'};\n                cursor: pointer; font-size: 1rem;\n                border-right: ${bRight}; border-bottom: ${bBottom};\n                transition: background 0.2s;\n            `;\n            cell.innerText = grid[r][c] === 0 ? '' : grid[r][c];\n            cell.onclick = () => {\n                if (!isInitial) {\n                    selected = { r, c };\n                    drawGrid();\n                }\n            };\n            gridEl.appendChild(cell);\n        }\n    }\n};\n\n// --- EVENTOS DE TECLADO (A) ---\nconst handleKeyDown = (e) => {\n    if (selected.r === -1) return;\n    \n    const key = e.key;\n    if (key >= '1' && key <= '9') {\n        grid[selected.r][selected.c] = parseInt(key);\n        drawGrid();\n    } else if (key === 'Backspace' || key === 'Delete' || key === '0') {\n        grid[selected.r][selected.c] = 0;\n        drawGrid();\n    }\n};\nwindow.addEventListener('keydown', handleKeyDown);\n\nconst numPad = document.createElement('div');\nnumPad.style.cssText = `display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; width: 100%;`;\n[1,2,3,4,5,6,7,8,9,0].forEach(n => {\n    const btn = document.createElement('button');\n    btn.innerText = n === 0 ? 'âŒ«' : n;\n    btn.style.cssText = `\n        padding: 10px; border: none; border-radius: 8px; background: #e0e5ec;\n        box-shadow: 4px 4px 8px #b8b9be, -4px -4px 8px #ffffff;\n        cursor: pointer; font-weight: bold; color: #475569;\n    `;\n    btn.onclick = () => {\n        if (selected.r !== -1) {\n            grid[selected.r][selected.c] = n;\n            drawGrid();\n        }\n    };\n    numPad.appendChild(btn);\n});\n\nconst btnReset = document.createElement('button');\nbtnReset.innerText = \"REINICIAR TABLERO\";\nbtnReset.style.cssText = `\n    width: 100%; padding: 12px; border: none; border-radius: 15px;\n    background: #e0e5ec; color: #475569; font-weight: 900;\n    cursor: pointer; box-shadow: 6px 6px 12px #b8b9be, -4px -4px 8px #ffffff;\n    font-size: 0.65rem; transition: 0.2s;\n`;\nbtnReset.onclick = () => { \n    grid = initialGrid.map(row => [...row]);\n    drawGrid();\n};\n\nbody.append(diffSelector, gridEl, numPad, btnReset);\nwin.append(header, body);\ndocument.body.appendChild(win);\n\n// ARRASTRE\nlet dragging = false, offset = {x:0, y:0};\nheader.onmousedown = (e) => {\n    dragging = true;\n    offset.x = e.clientX - win.offsetLeft;\n    offset.y = e.clientY - win.offsetTop;\n};\nwindow.addEventListener('mousemove', (e) => {\n    if (dragging) {\n        win.style.left = (e.clientX - offset.x) + 'px';\n        win.style.top = (e.clientY - offset.y) + 'px';\n    }\n});\nwindow.addEventListener('mouseup', () => dragging = false);\n\ndocument.getElementById(`close-${winId}`).onclick = () => {\n    window.removeEventListener('keydown', handleKeyDown);\n    win.remove();\n};\n\ngeneratePuzzle('EASY');\ndrawGrid();\nreturn \"Sudoku DinÃ¡mico Iniciado\";\n"
      }
    ]
  },
  "x": 0,
  "y": 0,
  "icon": "grid",
  "color": "text-indigo-600"
}